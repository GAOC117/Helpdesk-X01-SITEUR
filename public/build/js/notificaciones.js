var intervalo,toastBootstrap,cantidadAuxiliar,segundos=0,minutos=0;const alerta=document.querySelector("#notificacion-boton-texto"),notificacionEnlace=document.querySelector("#notificaciones-enlace"),btnCloseToast=document.querySelector("#btnCloseToast"),toastTrigger=document.getElementById("liveToastBtn"),toastLiveExample=document.getElementById("liveToast"),btnToast=document.querySelector(".btn-toast"),mensaje=document.querySelector("#mensaje-notificacion"),timeAgo=document.querySelector(".tiempo-ago");async function obenerNotificaciones(){try{const t="/api/obtenerNotificaciones",e=await fetch(t),o=await e.json(),n=o.idRol,i=o.cantidad,a=document.querySelector("#notificacion-boton-texto"),s=document.querySelector("#notificacion-boton-hamburguesa");"4"===n&&(s.style.display="none"),"4"!==n&&("0"===i?(a.style.display="none",s.style.display="none",toastBootstrap&&(console.log("1"),toastBootstrap.isShown()&&(timeAgo.innerHTML="",mensaje.innerHTML="",toastBootstrap.dispose(),clearInterval(intervalo),console.log("2")))):i>0&&i<=9?(a.style.display="flex",a.innerHTML=i,s.style.display="flex",cantidadAuxiliar!==i&&(console.log("6"),mostrarToast(i),cantidadAuxiliar=i)):i>9&&(a.style.display="flex",a.innerHTML="9+",s.style.display="flex",cantidadAuxiliar!==i&&(mostrarToast(i),cantidadAuxiliar=i)))}catch(t){console.log(t)}}async function limpiarNotificacionesBtnCerrar(){try{const t="/api/limpiarNotificaciones";await fetch(t)}catch(t){console.log(t)}}async function limpiarNotificaciones(){try{const t="/api/limpiarNotificaciones";await fetch(t);window.location.replace("/dashboard/ver-tickets")}catch(t){console.log(t)}}function mostrarToast(t){minutos=0,segundos=0,toastBootstrap&&(console.log("3"),toastBootstrap.isShown()&&(timeAgo.innerHTML="",mensaje.innerHTML="",toastBootstrap.dispose(),clearInterval(intervalo),console.log("4"))),console.log("5"),toastBootstrap=bootstrap.Toast.getOrCreateInstance(toastLiveExample),timeAgo.innerHTML="Justo ahora",t>0&&t<=9?1===parseInt(t)?mensaje.innerHTML="Tienes 1 ticket nuevo":mensaje.innerHTML="Tienes "+t+" tickets nuevos":parseInt(t)>9&&(mensaje.innerHTML="Tienes mÃ¡s de 10 tickets nuevos"),toastBootstrap.show(),intervalo=setInterval(()=>{++segundos%60==0&&(minutos++,timeAgo.innerHTML=1===minutos?"Hace "+minutos+" minuto":"Hace "+minutos+" minutos")},1e3)}document.addEventListener("DOMContentLoaded",(function(){obenerNotificaciones()})),alerta.addEventListener("click",limpiarNotificaciones),notificacionEnlace.addEventListener("click",limpiarNotificaciones),setInterval((function(){obenerNotificaciones()}),2e3),btnCloseToast.addEventListener("click",()=>{timeAgo.innerHTML="",mensaje.innerHTML="",toastBootstrap=void 0,clearInterval(intervalo),console.log("7"),window.location.href.includes("ver-tickets")&&(cantidadAuxiliar=void 0,limpiarNotificacionesBtnCerrar(),obenerNotificaciones())});