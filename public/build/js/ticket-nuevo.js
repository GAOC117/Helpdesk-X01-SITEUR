function iniciarApp(){}function eliminarBordeComentario(){const e=document.querySelector("#comentariosReporte");e.addEventListener("input",()=>{e.style.outline="none"})}function buscarEmpleado(e,o,i){const n=document.querySelector(e);document.querySelector(o),document.querySelector(i);n.addEventListener("input",()=>{""!==n.value&&"0"!=n.value&&(console.log("de aqui soy"),obtenerEmpleado(e,o,i))})}async function obtenerEmpleado(e,o,i){const n=document.querySelector(e),t=document.querySelector(o),c=document.querySelector(i);if(""!==e.value)try{const e="/api/obtenerEmpleado?idEmp="+n.value,o=await fetch(e),i=await o.json();if(null!==i){const{nombre:e,apellidoPaterno:o,apellidoMaterno:a,extension:l}=i;t.value=l,c.value=e+" "+o+" "+a,n.style.outline="none"}else t.value="",c.value="",n.style.outline="1px solid red"}catch(e){console.log(e)}}async function obtenerSubclasificacion(){document.querySelector("#formulario-fieldset--clasificacion").querySelector("#formulario-fieldset--clasificacion > span").style.outline="none";try{const e=document.querySelector("#idClasificacionProblema").value;console.log(e);const o=document.querySelector("#idSubclasificacionProblema"),i="/api/obtenerSubclasificacion?idClasificacion="+e,n=await fetch(i),t=await n.json();o.innerHTML="";const c=document.createElement("option");c.text="--Seleccionar--",c.selected=!0,c.disabled=!0,o.appendChild(c),t.forEach(e=>{const i=document.createElement("option"),{id:n,idClasificacion:t,descripcion:c}=e;i.text=c,i.value=n,o.appendChild(i)})}catch(e){console.log(e)}}function obtenerSubclasificacionAlInicio(){const e=document.querySelector("#idClasificacionProblema").value;setTimeout(()=>{$.isNumeric(e)&&obtenerSubclasificacion()},100)}function obtenerSubclasificacionIniciando(){const e=sessionStorage.getItem("idClasificacion");e&&setTimeout(()=>{$("#idSubclasificacionProblema").val(e).trigger("change")},300)}function getIdSubclasificacion(){document.querySelector("#formulario-fieldset--subclasificacion").querySelector("#formulario-fieldset--subclasificacion > span").style.outline="none";const e=document.querySelector("#idSubclasificacionProblema").value;sessionStorage.setItem("idClasificacion",e)}function registrarTicket(){document.querySelector("#botonRegistrar").addEventListener("click",obtenerDatosTicket)}function msg(){alert("el mesnaej")}async function obtenerDatosTicket(){const e=document.querySelector("#botonRegistrar");var o="Los siguientes campos (marcados en rojo) deben ser llenados:<br><br>";const i=document.querySelector("#idEmpReporta"),n=document.querySelector("#extensionReporta"),t=document.querySelector("#nombreReporta"),c=document.querySelector("#idEmpRequiere"),a=document.querySelector("#extensionRequiere"),l=document.querySelector("#extensionRequiere"),r=document.querySelector("#idClasificacionProblema"),u=document.querySelector("#idSubclasificacionProblema"),s=document.querySelector("#comentariosReporte"),d=document.querySelector("#formulario-fieldset--clasificacion").querySelector("#formulario-fieldset--clasificacion > span"),m=document.querySelector("#formulario-fieldset--subclasificacion").querySelector("#formulario-fieldset--subclasificacion > span");if(""==i.value&&(o+="-Expediente de quién reporta.<br>",i.style.outline="1px solid red"),""==c.value&&(o+="-Expediente de quién requiere.<br>",c.style.outline="1px solid red"),"--Seleccionar--"==r.value&&(o+="-Clasificación del problema presentado.<br>",d.style.outline="1px solid red"),"--Seleccionar--"!=u.value&&""!=u.value||(o+="-Subclasificación del problema presentado.<br>",m.style.outline="1px solid red"),""==s.value&&(o+="-Un comentario sobre el problema presentado.<br>",s.style.outline="1px solid red"),""!==i.value&&""!==n.value&&""!==t.value&&""!==c.value&&""!==a.value&&l.value&&"--Seleccionar--"!==r.value&&"--Seleccionar--"!==u.value&&""!=s.value){e.disabled=!0;const o=new FormData;o.append("idEmpReporta",i.value),o.append("idEmpRequiere",c.value),o.append("idClasificacionProblema",r.value),o.append("idSubclasificacionProblema",u.value),o.append("comentariosReporte",s.value),o.forEach(e=>{console.log(e)});try{const i="/api/generar-ticket",n=await fetch(i,{method:"POST",body:o}),t=await n.json();console.log(t),t?Swal.fire({icon:"success",title:"Éxito",html:'El ticket fue registrado con éxito con el folio <span class="folio">#'+t.id+"</span> guardalo para cualquier duda o aclaración",button:"OK"}).then(()=>{setTimeout(()=>{sessionStorage.clear,window.location.replace("/dashboard/asignar-tickets?id="+t.id)},1e3)}):e.disabled=!1}catch(e){console.log(e)}}else Swal.fire({icon:"warning",title:"Atención",html:o,button:"OK"})}document.addEventListener("DOMContentLoaded",(function(){setTimeout(()=>{obtenerEmpleado("#idEmpReporta","#extensionReporta","#nombreReporta"),obtenerEmpleado("#idEmpRequiere","#extensionRequiere","#nombreRequiere")},100),buscarEmpleado("#idEmpReporta","#extensionReporta","#nombreReporta"),buscarEmpleado("#idEmpRequiere","#extensionRequiere","#nombreRequiere"),obtenerSubclasificacionAlInicio(),obtenerSubclasificacionIniciando(),eliminarBordeComentario(),iniciarApp(),registrarTicket()})),$("#idClasificacionProblema").on("select2:select",obtenerSubclasificacion),$("#idSubclasificacionProblema").on("select2:select",getIdSubclasificacion);