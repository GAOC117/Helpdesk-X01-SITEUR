var grafico,graficoB,abiertos=0,pausados=0,escalados=0,cerrados=0,abiertos1=0,pausados1=0,escalados1=0,cerrados1=0,abiertos2=0,pausados2=0,escalados2=0,cerrados2=0,totales=0,totales1=0,totales2=0,mesAct=0,alto=0,ancho=0,abiertoAux=0,pausadoAux=0,escaladoAux=0,cerradoAux=0;const barra=document.getElementById("myChart1");async function getMonthlyTickets(){try{const a="/api/getMonthlyTickets",e=await fetch(a),o=await e.json();abiertos=o.abiertos.abiertos,pausados=o.pausados.pausados,escalados=o.escalados.escalados,cerrados=o.cerrados.cerrados,totales=o.total.total,abiertos1=o.abiertos1.abiertos1,pausados1=o.pausados1.pausados1,escalados1=o.escalados1.escalados1,cerrados1=o.cerrados1.cerrados1,totales1=o.total1.total1,abiertos2=o.abiertos2.abiertos2,pausados2=o.pausados2.pausados2,escalados2=o.escalados2.escalados2,cerrados2=o.cerrados2.cerrados2,totales2=o.total2.total2,mesAct=o.mesActual;const s=document.querySelector("#tickets--abiertos"),r=document.querySelector("#tickets--pausados"),t=document.querySelector("#tickets--escalados"),d=document.querySelector("#tickets--cerrados"),c=document.querySelector("#tickets--totales");s.innerHTML=abiertos,r.innerHTML=pausados,t.innerHTML=escalados,d.innerHTML=cerrados,c.innerHTML=totales,abiertoAux===abiertos&&pausadoAux===pausados&&escaladoAux===escalados&&cerradoAux===cerrados||(generarChart(),graficoBarras(mesAct,abiertos,abiertos1,abiertos2,pausados,pausados1,pausados2,escalados,escalados1,escalados2,cerrados,cerrados1,cerrados2,totales,totales1,totales2),abiertoAux=abiertos,pausadoAux=pausados,escaladoAux=escalados,cerradoAux=cerrados)}catch(a){console.log(a)}}function generarChart(){setTimeout(()=>{const a=document.getElementById("myChart");grafico&&grafico.destroy();grafico=new Chart(a,{type:"pie",data:{labels:["Abiertos","Pausados","Escalados","Cerrados"],datasets:[{label:"Tickets",data:[abiertos,pausados,escalados,cerrados],backgroundColor:["rgb(248, 88, 88)","#99998C","#F6A215","#3e8b41"],hoverOffset:4}]},options:{responsive:!1}})},200)}function graficoBarras(a,e,o,s,r,t,d,c,l,i,b,n,u,g,p,m){setTimeout(()=>{meses=["","Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];let A,h,C=meses[a];1===a?(A=meses[12],h=meses[11]):2==a?(A=meses[1],h=meses[12]):(A=meses[a-1],h=meses[a-2]),console.log(a+" "+C+" "+A+" "+h),graficoB&&graficoB.destroy(),window.matchMedia("(width > 768px)").matches?(barra.height=500,barra.width=500):(barra.height=300,barra.width=300);graficoB=new Chart(barra,{type:"bar",data:{labels:[C,A,h],datasets:[{label:"Abiertos",data:[e,o,s],backgroundColor:["rgb(248, 88, 88)","rgb(248, 88, 88)","rgb(248, 88, 88)"],borderColor:["rgb(248, 88, 88)","rgb(248, 88, 88)","rgb(248, 88, 88)"],borderWidth:1},{label:"Pausados",data:[r,t,d],backgroundColor:["#99998C","#99998C","#99998C"],borderColor:["#99998C","#99998C","#99998C"],borderWidth:1},{label:"Escalados",data:[c,l,i],backgroundColor:["#F6A215","#F6A215","#F6A215"],borderColor:["#F6A215","#F6A215","#F6A215"],borderWidth:1},{label:"Cerrados",data:[b,n,u],backgroundColor:["#3e8b41","#3e8b41","#3e8b41"],borderColor:["#3e8b41","#3e8b41","#3e8b41"],borderWidth:1},{label:"Totales",data:[g,p,m],backgroundColor:["rgb(33,52,92)","rgb(33,52,92)","rgb(33,52,92)"],borderColor:["rgb(33,52,92)","rgb(33,52,92)","rgb(33,52,92)"],borderWidth:1}]},options:{scales:{y:{beginAtZero:!0}},responsive:!1,maintainAspectRatio:!1}})},200)}document.addEventListener("DOMContentLoaded",(function(){getMonthlyTickets()})),setInterval((function(){getMonthlyTickets()}),2e3),addEventListener("resize",()=>{graficoBarras(mesAct,abiertos,abiertos1,abiertos2,pausados,pausados1,pausados2,escalados,escalados1,escalados2,cerrados,cerrados1,cerrados2,totales,totales1,totales2)});