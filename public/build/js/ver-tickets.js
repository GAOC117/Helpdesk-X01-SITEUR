limpiarNotificaciones(),document.addEventListener("DOMContentLoaded",(function(){llenarTablaTickets()}));const folio=document.querySelector("#idFolio"),atiende=document.querySelector("#idAtiende"),fecha=document.querySelector("#idFecha"),requiere=document.querySelector("#idRequiere"),estado=document.querySelector("#idEstado"),clasificacion=document.querySelector("#idClasificacion"),subclasificacion=document.querySelector("#idSubclasificacion"),comentarios=document.querySelector("#idComentarios"),comentariosSoporte=document.querySelector("#idComentariosSoporte");async function limpiarNotificaciones(){try{const a="/api/limpiarNotificaciones";await fetch(a)}catch(a){console.log(a)}}function mostrarMesEnCurso(){var a=(new Date).getMonth()+1;const e=document.querySelector("#idFecha");e.addEventListener(),e.value=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][a-1]}function busqueda(){document.querySelector("#idfolio").addEventListener("keyup",kha)}async function llenarTablaTickets(){const a=document.querySelector(".tabla__body.tickets");try{const e="/api/obtenerTablaTickets",t=await fetch(e),i=await t.json(),o=i.tablaRows,c=i.idRol,s=i.nombreLogueado;a.innerHTML="",o.forEach(e=>{const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("td"),l=document.createElement("td"),d=document.createElement("td"),n=document.createElement("td"),r=document.createElement("td"),u=document.createElement("td"),b=document.createElement("td"),_=document.createElement("td"),f=document.createElement("td"),m=document.createElement("DIV"),{idTicket:p,fechaCaptura:h,atiende:L,nombreRequiere:k,estadoTicket:C,clasificacion:T,subclasificacion:E,comentarios:y,comentariosSoporte:S}=e;t.classList.add("tabla__row"),i.textContent=p,o.textContent=h.split("-")[2]+"/"+h.split("-")[1]+"/"+h.split("-")[0],l.textContent=L,d.textContent=k,n.textContent=C,r.textContent=T,u.textContent=E,b.textContent=y,_.textContent=S,i.classList.add("tabla__td"),o.classList.add("tabla__td"),l.classList.add("tabla__td"),d.classList.add("tabla__td"),n.classList.add("tabla__td"),r.classList.add("tabla__td"),u.classList.add("tabla__td"),b.classList.add("tabla__td"),_.classList.add("tabla__td"),f.classList.add("tabla__td"),"Abierto"===C&&n.classList.add("estado-abierto"),"Pausado"===C&&n.classList.add("estado-pausado"),"Escalado"===C&&n.classList.add("estado-escalado"),"Cerrado"===C&&n.classList.add("estado-cerrado"),m.classList.add("tabla__tickets--botones"),"4"===c&&m.classList.add("tabla__tickets--botones--colaborador"),m.innerHTML="<a href='/dashboard/historial-tickets?id="+p+"' title='Historial del ticket' class='tabla__boton-azul tabla__boton'><i class='fa-solid fa-calendar-days fa-xl'></i></a>","2"===c&&("Abierto"===C||"Pausado"===C||"Escalado"===C?("Sin asignar"===L&&(m.innerHTML+="<a href='/dashboard/asignar-tickets?id="+p+"' title='Asignar ticket' class='tabla__boton-verde-limon tabla__boton'><i class='fa-solid fa-person-walking-arrow-loop-left fa-xl'></i></i></a>"),"Sin asignar"!==L&&(m.innerHTML+="<a href='/dashboard/pausar-tickets?id="+p+"' title='Pausar ticket' class='tabla__boton-gris tabla__boton'><i class='fa-solid fa-circle-pause fa-xl'></i></a>",m.innerHTML+="<a href='/dashboard/escalar-tickets?id="+p+"' title='Escalar ticket' class='tabla__boton-naranja tabla__boton'><i class='fa-solid fa-arrow-trend-up fa-xl'></i></a>",m.innerHTML+="<a href='/dashboard/cerrar-tickets?id="+p+"' title='Cerrar ticket' class='tabla__boton-verde tabla__boton'><i class='fa-solid fa-circle-check fa-xl'></i></a>")):m.innerHTML+="<p class='tabla__cerrado'>Ticket cerrado</p>"),"1"!==c&&"3"!==c||("Abierto"===C||"Pausado"===C||"Escalado"===C?"Sin asignar"!==L&&L===s&&(m.innerHTML+="<a href='/dashboard/pausar-tickets?id="+p+"' title='Pausar ticket' class='tabla__boton-gris tabla__boton'><i class='fa-solid fa-circle-pause fa-xl'></i></a>","1"===c&&(m.innerHTML+="<a href='/dashboard/escalar-tickets?id="+p+"' title='Escalar ticket' class='tabla__boton-naranja tabla__boton'><i class='fa-solid fa-arrow-trend-up fa-xl'></i></a>"),m.innerHTML+="<a href='/dashboard/cerrar-tickets?id="+p+"' title='Cerrar ticket' class='tabla__boton-verde tabla__boton'><i class='fa-solid fa-circle-check fa-xl'></i></a>"):m.innerHTML+="<p class='tabla__cerrado'>Ticket cerrado</p>"),"4"===c&&"Cerrado"===C&&(m.innerHTML+="<p class='tabla__cerrado'>Ticket cerrado</p>"),t.appendChild(i),t.appendChild(o),t.appendChild(l),t.appendChild(d),t.appendChild(n),t.appendChild(r),t.appendChild(u),t.appendChild(b),t.appendChild(_),f.appendChild(m),t.appendChild(f),a.appendChild(t)})}catch(a){console.log(a)}$(document).ready((function(){$(".filter").multifilter()}))}setInterval((function(){""===folio.value&&""===atiende.value&&""===fecha.value&&""===requiere.value&&""===estado.value&&""===clasificacion.value&&""===subclasificacion.value&&""===comentarios.value&&""===comentariosSoporte.value&&llenarTablaTickets()}),2e3);