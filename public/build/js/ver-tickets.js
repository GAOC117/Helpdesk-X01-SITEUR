document.addEventListener("DOMContentLoaded",(function(){llenarTablaTickets()}));const folio=document.querySelector("#idFolio"),atiende=document.querySelector("#idAtiende"),fecha=document.querySelector("#idFecha"),requiere=document.querySelector("#idRequiere"),estado=document.querySelector("#idEstado"),clasificacion=document.querySelector("#idClasificacion"),subclasificacion=document.querySelector("#idSubclasificacion"),comentarios=document.querySelector("#idComentarios"),comentariosSoporte=document.querySelector("#idComentariosSoporte");function mostrarMesEnCurso(){var e=(new Date).getMonth()+1;const a=document.querySelector("#idFecha");a.addEventListener(),a.value=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][e-1]}function busqueda(){document.querySelector("#idfolio").addEventListener("keyup",kha)}async function llenarTablaTickets(){const e=document.querySelector(".tabla__body.tickets");try{const a="/api/obtenerTablaTickets",t=await fetch(a),i=await t.json(),o=i.tablaRows,c=i.idRol;e.innerHTML="",o.forEach(a=>{const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("td"),l=document.createElement("td"),d=document.createElement("td"),n=document.createElement("td"),s=document.createElement("td"),r=document.createElement("td"),u=document.createElement("td"),b=document.createElement("td"),_=document.createElement("td"),f=document.createElement("DIV"),{idTicket:m,fechaCaptura:p,atiende:h,nombreRequiere:k,estadoTicket:C,clasificacion:L,subclasificacion:E,comentarios:T,comentariosSoporte:S}=a;t.classList.add("tabla__row"),p.split("-")[1]<10?p.split("-")[1][1]:p.split("-")[1],i.textContent=m,o.textContent=p.split("-")[2]+"/"+p.split("-")[1]+"/"+p.split("-")[0],l.textContent=h,d.textContent=k,n.textContent=C,s.textContent=L,r.textContent=E,u.textContent=T,b.textContent=S,i.classList.add("tabla__td"),o.classList.add("tabla__td"),l.classList.add("tabla__td"),d.classList.add("tabla__td"),n.classList.add("tabla__td"),s.classList.add("tabla__td"),r.classList.add("tabla__td"),u.classList.add("tabla__td"),b.classList.add("tabla__td"),_.classList.add("tabla__td"),f.classList.add("tabla__tickets--botones"),"4"===c&&f.classList.add("tabla__tickets--botones--colaborador"),f.innerHTML="<a href='/dashboard/historial-tickets?id="+m+"' title='Historial del ticket' class='tabla__boton-azul tabla__boton'><i class='fa-solid fa-clock fa-xl'></i></a>","1"!==c&&"2"!==c||("Abierto"===C||"Pausado"===C||"Escalado"===C?("Sin asignar"===h&&(f.innerHTML+="<a href='/dashboard/asignar-tickets?id="+m+"' title='Asignar ticket' class='tabla__boton-verde-limon tabla__boton'><i class='fa-solid fa-person-walking-arrow-loop-left fa-xl'></i></i></a>"),"Sin asignar"!==h&&(f.innerHTML+="<a href='/dashboard/pausar-tickets?id="+m+"' title='Pausar ticket' class='tabla__boton-gris tabla__boton'><i class='fa-solid fa-circle-pause fa-xl'></i></a>",f.innerHTML+="<a href='/dashboard/escalar-tickets?id="+m+"' title='Escalar ticket' class='tabla__boton-naranja tabla__boton'><i class='fa-solid fa-arrow-trend-up fa-xl'></i></a><a href='/dashboard/cerrar-tickets?id="+m+"'title='Cerrar ticket' class='tabla__boton-verde tabla__boton'><i class='fa-solid fa-circle-check fa-xl'></i></a>")):f.innerHTML+="<p class='tabla__cerrado'>Ticket cerrado</p>"),"3"===c&&(f.innerHTML+="Abierto"===C||"Pausado"===C||"Escalado"===C?"<a href='/dashboard/pausar-tickets?id="+m+"' title='Pausar ticket' class='tabla__boton-gris tabla__boton'><i class='fa-solid fa-circle-pause fa-xl'></i></a><a href='/dashboard/cerrar-tickets?id="+m+"' title='Cerrar ticket' class='tabla__boton-verde tabla__boton'><i class='fa-solid fa-circle-check fa-xl'></i></a>":"<p class='tabla__cerrado'>Ticket cerrado</p>"),"4"===c&&"Cerrado"===C&&(f.innerHTML+="<p class='tabla__cerrado'>Ticket cerrado</p>"),t.appendChild(i),t.appendChild(o),t.appendChild(l),t.appendChild(d),t.appendChild(n),t.appendChild(s),t.appendChild(r),t.appendChild(u),t.appendChild(b),_.appendChild(f),t.appendChild(_),e.appendChild(t)})}catch(e){console.log(e)}$(document).ready((function(){$(".filter").multifilter()}))}setInterval((function(){""===folio.value&&""===atiende.value&&""===fecha.value&&""===requiere.value&&""===estado.value&&""===clasificacion.value&&""===subclasificacion.value&&""===comentarios.value&&""===comentariosSoporte.value&&llenarTablaTickets()}),2e3);